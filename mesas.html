<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Card√°pio</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    .pedido-conta-verde {
      background-color: green;
      color: white; /* Altera a cor do texto para branco */
      border: none; /* Remove a borda */
      cursor: not-allowed; /* Muda o cursor para indicar que n√£o √© clic√°vel */
    }
  </style>
  <script>
    let cart = {};
    let totalPrice = 0;

    function pedirConta() {
      const button = document.querySelector('.pedido-conta');
      button.classList.add('pedido-conta-verde'); // Adiciona a classe verde
      button.disabled = true; // Desabilita o bot√£o para evitar m√∫ltiplas solicita√ß√µes
      alert("Conta pedida!"); // Exemplo de a√ß√£o ao clicar no bot√£o
    }

    function addToCart(product, price) {
      if (cart[product]) {
        cart[product].quantity += 1;
      } else {
        cart[product] = { quantity: 1, price: price };
      }
      updateCart();
      saveCartToLocalStorage(); // Salva o carrinho no localStorage
    }

    function saveCartToLocalStorage() {
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    function updateCart() {
      const cartList = document.getElementById('cart-list');
      cartList.innerHTML = '';
      totalPrice = 0;

      for (const product in cart) {
        const item = cart[product];

        const listItem = document.createElement('li');
        listItem.textContent = `${product} (${item.quantity}) - R$ ${item.price.toFixed(2)}`;
        
        // Adiciona um √≠cone para remover uma unidade do item
        const removeIcon = document.createElement('i');
        removeIcon.className = 'fas fa-trash'; // √çcone de lixeira
        removeIcon.onclick = () => removeFromCart(product); // Chama a fun√ß√£o para remover 1 unidade
        removeIcon.style.cursor = 'pointer'; // Muda o cursor para indicar que √© clic√°vel
        removeIcon.style.marginLeft = '10px'; // Espa√ßamento entre o texto e o √≠cone
        
        listItem.appendChild(removeIcon); // Adiciona o √≠cone ao item da lista
        cartList.appendChild(listItem);
        totalPrice += item.price * item.quantity;
      }

      const totalItem = document.createElement('li');
      totalItem.textContent = `Total: R$ ${totalPrice.toFixed(2)}`;
      totalItem.style.fontWeight = 'bold';
      cartList.appendChild(totalItem);
    }

    function removeFromCart(product) {
      if (cart[product]) {
        cart[product].quantity -= 1; // Decrementa a quantidade

        if (cart[product].quantity <= 0) {
          delete cart[product]; // Remove o produto se a quantidade for zero ou negativa
        }

        saveCartToLocalStorage(); // Atualiza o localStorage
        updateCart(); // Atualiza a exibi√ß√£o do carrinho
      }
    }

    function toggleCart() {
      const cartDiv = document.getElementById('cart');
      cartDiv.style.display = cartDiv.style.display === 'block' ? 'none' : 'block';
    }

    function requestOrder() {
      const orderDetails = JSON.stringify(cart); // Converte o carrinho em uma string JSON
      localStorage.setItem('order', orderDetails); // Armazena no localStorage
      alert("Pedido solicitado com sucesso!");
    }

    function loadProducts() {
      fetch('info.json')
        .then(response => response.json())
        .then(products => {
          const cardContainer = document.querySelector('.card-container');
          products.forEach(product => {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                            <img src="${product.imagem}" alt="${product.nome}">
                            <div>
                                <h2>${product.nome}</h2>
                                <p>${product.descricao}</p>
                                <p>R$ ${product.preco.toFixed(2)}</p>
                                <button class="button" onclick="addToCart('${product.nome}', ${product.preco})">Adicionar</button>
                            </div>
                        `;
            cardContainer.appendChild(card);
          });
        })
        .catch(error => console.error('Erro ao carregar os produtos:', error));
    }

    window.onload = loadProducts;
  </script>
</head>

<body>
  <div class="header">
    <button class="pedido-conta" onclick="pedirConta()">Pedir Conta</button>
  </div>
  <div class="card-container"></div>
  <div class="cart-icon" onclick="toggleCart()">
    üõí
  </div>
  <div class="cart" id="cart">
    <h2>Carrinho</h2>
    <ul id="cart-list" class="cart-list"></ul>
  </div>
  <button class="request-button" onclick="requestOrder()">Solicitar Pedido</button>
</body>

</html>
